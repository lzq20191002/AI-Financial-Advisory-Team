# 金融市场分析系统 - 提示工程文档

## 项目概述

金融市场分析系统是一个基于大语言模型的智能分析平台，集成多代理协作架构，为用户提供实时市场数据、智能分析报告、个性化投资建议等一站式金融服务。系统通过调用多种金融API和数据源，结合先进的NLP和数据分析技术，帮助用户快速理解市场趋势并做出更明智的投资决策。

## 项目架构

系统采用多代理协作架构，主要组件包括：

```
FinancialMarketAnalyzer/
├── app.py              # 主应用程序入口，Flask Web服务
├── agents/             # 智能代理模块
│   ├── query_agent.py  # 查询代理，处理用户查询请求
│   ├── media_agent.py  # 媒体代理，分析市场新闻和舆情
│   ├── insight_agent.py# 洞察代理，生成深度市场分析
│   └── report_agent.py # 报告代理，生成结构化分析报告
├── tools/              # 工具模块
│   ├── financial_data_tools.py # 金融数据获取工具
│   └── analysis_tools.py       # 数据分析工具
├── models/             # 数据模型
├── templates/          # 前端页面模板
├── static/             # 静态资源
├── reports/            # 生成的报告存储
├── utils/              # 工具函数
├── requirements.txt    # 项目依赖
└── start.bat           # 启动脚本
```

## 核心功能模块

### 1. 智能代理系统

系统采用多代理协作模式，每个代理负责特定领域的任务：

#### QueryAgent (查询代理)
- 处理用户的自然语言查询
- 调用相应的金融数据工具获取信息
- 提供准确的市场数据和统计信息

#### MediaAgent (媒体代理)
- 收集和分析市场相关新闻
- 评估新闻对市场的潜在影响
- 识别热点话题和趋势

#### InsightAgent (洞察代理)
- 基于历史数据进行趋势分析
- 生成深度市场洞察和预测
- 提供投资策略建议

#### ReportAgent (报告代理)
- 整合各代理的分析结果
- 生成结构化的市场分析报告
- 支持HTML和JSON多种格式导出

### 2. 工具模块

#### FinancialDataTools (金融数据工具)
- 股票价格和历史数据获取
- 市场指数跟踪
- 公司财务数据查询
- 行业表现对比分析

#### AnalysisTools (分析工具)
- 技术指标计算
- 相关性分析
- 异常检测
- 可视化数据生成

### 3. Web界面和API

系统提供直观的Web界面和RESTful API接口：

- **市场概览**：展示主要市场指数、热点板块和个股表现
- **行业分析**：提供各行业表现对比和趋势分析
- **新闻中心**：实时更新市场新闻和舆情分析
- **报告生成**：根据用户需求生成个性化分析报告
- **API接口**：支持第三方应用集成

## 提示工程设计

### 系统提示模板

#### QueryAgent提示模板
```
你是一个专业的金融数据查询助手，负责准确、快速地响应用户关于金融市场的查询。

工具访问权限：
- 获取股票价格和历史数据
- 查询市场指数
- 获取公司基本面信息
- 检索行业数据

请根据用户的查询，调用适当的工具获取信息，并以清晰、专业的方式呈现结果。
对于数据中的异常或不完整情况，请明确指出。
```

#### MediaAgent提示模板
```
你是一个金融市场新闻分析专家，负责分析市场新闻并评估其对投资决策的影响。

分析要点：
1. 新闻的时效性和相关性
2. 对特定公司、行业或整体市场的潜在影响
3. 可能的市场反应和持续时间
4. 相关的风险因素

请以结构化的方式呈现分析结果，包括关键信息摘要、影响评估和潜在投资启示。
```

#### InsightAgent提示模板
```
你是一位资深金融分析师，擅长基于历史数据和市场信息提供深度洞察。

分析任务：
- 识别市场趋势和转折点
- 评估投资机会和风险
- 提供基于数据的投资策略建议
- 分析宏观经济因素对市场的影响

请结合技术分析和基本面分析，生成具有前瞻性的市场洞察。分析应客观、全面，并明确说明分析依据和局限性。
```

#### ReportAgent提示模板
```
你是一位专业的金融报告撰写专家，负责整合各类分析结果，生成结构化、专业的市场分析报告。

报告结构：
1. 市场概览：主要指数表现、市场情绪概览
2. 行业分析：各行业表现对比、热点行业分析
3. 重点公司分析：表现突出的个股分析
4. 风险因素：市场面临的主要风险
5. 投资建议：基于分析的投资策略建议
6. 结论与展望：对未来市场走势的展望

请确保报告内容客观、准确、易于理解，并包含适当的数据可视化元素。
```

### 用户输入提示优化

为了获得更准确、相关的回答，系统建议用户使用以下提示格式：

#### 股票查询提示
```
请提供以下信息以获取准确的股票数据：
- 股票代码（如AAPL, TSLA等）
- 查询类型（价格、历史数据、基本面等）
- 时间范围（如需要历史数据）
- 具体的分析需求（如同比增长、波动率等）
```

#### 市场分析提示
```
请说明以下内容以获取个性化的市场分析：
- 关注的市场或板块（如美股、A股、科技板块等）
- 分析时间范围（短期、中期或长期）
- 关注的分析维度（技术面、基本面、资金面等）
- 特定的分析需求或问题
```

#### 报告生成提示
```
要生成定制化的市场分析报告，请提供：
- 报告主题（如"科技行业月度分析"、"市场趋势展望"等）
- 关注的市场范围（全球、地区或特定市场）
- 报告深度（简要概述或详细分析）
- 特定的关注点或问题
```

## 安装与配置

### 环境要求
- Python 3.8+
- pip包管理器
- Windows操作系统

### 安装步骤

1. 克隆或下载项目代码到本地

2. 运行启动脚本自动配置环境
   ```bash
   start.bat
   ```
   启动脚本会自动：
   - 创建虚拟环境
   - 安装所需依赖
   - 配置环境变量
   - 启动Web服务

3. 手动配置（可选）
   - 复制`.env.example`为`.env`
   - 编辑`.env`文件，填入所需的API密钥

### API配置

系统需要以下API密钥（可选，根据实际使用的功能配置）：
- FINANCIAL_API_KEY：金融数据API密钥
- NEWS_API_KEY：新闻数据API密钥
- OPENAI_API_KEY：OpenAI API密钥（用于增强分析能力）

## 使用方法

### Web界面访问
启动系统后，在浏览器中访问：
```
http://localhost:5000
```

### API接口使用

系统提供以下主要API接口：

#### 获取股票数据
```
GET /api/stock?symbol={symbol}&period={period}
```
参数：
- symbol：股票代码
- period：时间范围（1d, 1m, 3m, 1y, 5y等）

#### 获取市场分析
```
GET /api/market-analysis?sector={sector}&timeframe={timeframe}
```
参数：
- sector：行业/板块代码
- timeframe：分析时间范围

#### 获取市场新闻
```
GET /api/news?category={category}&limit={limit}
```
参数：
- category：新闻类别
- limit：返回数量限制

#### 生成分析报告
```
POST /api/generate-report
```
请求体：
```json
{
  "title": "报告标题",
  "focus": "关注领域",
  "depth": "分析深度",
  "timeframe": "时间范围"
}
```

## 系统优化建议

### 提示优化策略

1. **明确任务定义**：为每个代理提供清晰的角色定位和任务描述
2. **结构化输出格式**：指定输出格式，确保结果易于处理和展示
3. **逐步引导**：复杂任务可以分解为多个步骤，逐步引导代理完成
4. **提供示例**：为复杂查询提供示例，帮助用户提供更精确的输入
5. **上下文管理**：维护对话历史，支持多轮交互和上下文理解

### 性能优化建议

1. **缓存策略**：对频繁请求的数据实施缓存机制，减少API调用
2. **并行处理**：利用多线程或异步处理提升系统响应速度
3. **模型微调**：基于金融领域数据对模型进行微调，提升专业准确性
4. **错误处理**：完善的错误处理和重试机制，提高系统稳定性
5. **监控与日志**：建立完善的监控和日志系统，及时发现和解决问题

## 注意事项

1. **数据准确性**：系统提供的分析基于公开数据，仅供参考，不构成投资建议
2. **API使用限制**：部分数据API可能有调用频率限制，请合理使用
3. **环境变量安全**：确保API密钥等敏感信息通过环境变量配置，不硬编码在代码中
4. **性能优化**：处理大量数据时可能需要增加服务器资源或优化查询逻辑

## 后续开发计划

1. 扩展数据源，支持更多市场和资产类别
2. 增强AI分析能力，提供更智能的投资建议
3. 开发移动端应用，提供更便捷的访问方式
4. 添加用户账户系统，支持个性化设置和历史记录
5. 增加社交功能，支持投资观点分享和讨论

---

© 2024 金融市场分析系统 版权所有